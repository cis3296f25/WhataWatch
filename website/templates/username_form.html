{% extends "base.html" %}

{% block title %}Import Letterboxd - Enter Username{% endblock %}

{% block content %}
<h1 class="text-2xl font-bold mb-6">Import Letterboxd watched films</h1>

<form method="post" class="space-y-4">
    {% csrf_token %}
    <div>
      <label for="username" class="block text-sm text-gray-300">Letterboxd username</label>
      <input 
        id="username"
        name="username"
        type="text"
        value="{{ username|default:'' }}"
        placeholder="letterboxd-username"
        class="mt-1 px-4 py-2 rounded-md bg-slate-700 border border-white/10 w-full"
        required
      />
    </div>

    <button 
        type="submit"
        class="px-4 py-2 rounded-md bg-indigo-600 hover:bg-indigo-700 transition"
    >
        Import
    </button>
</form>

{% if scraping_info %}
  <div class="mt-6">
    <p class="text-sm text-gray-300">Scraped pages: {{ scraping_info.pages_scraped }} â€” unique films found: {{ scraping_info.found }}</p>

    <h2 class="mt-4 text-lg font-semibold">Imported / Updated movies</h2>
    <ul class="mt-2 space-y-2">
      {% for m in scraping_info.movies %}
        <li class="glass p-3 rounded-md">
          <a href="{{ m.letterboxd_url }}" class="font-semibold text-indigo-300" target="_blank" rel="noopener noreferrer">
            {{ m.title }}{% if m.year %} ({{ m.year }}){% endif %}
          </a>
          {% if m.rating %}<span class="ml-3 text-sm text-gray-400">rating: {{ m.rating }}</span>{% endif %}
        </li>
      {% endfor %}
    </ul>
  </div>
{% endif %}
{% endblock %}